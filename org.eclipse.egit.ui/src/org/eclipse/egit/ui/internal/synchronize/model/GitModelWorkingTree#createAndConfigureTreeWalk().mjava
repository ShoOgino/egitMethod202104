	@Override
	protected TreeWalk createAndConfigureTreeWalk() throws IOException {
		TreeWalk tw = createTreeWalk();
		tw.setRecursive(true);

		Repository repo = getRepository();
		tw.addTree(new DirCacheIterator(repo.readDirCache()));
		tw.addTree(new FileTreeIterator(repo));
		dirCacheIteratorNth = 0;

		NotIgnoredFilter notIgnoredFilter = new NotIgnoredFilter(1);
		tw.setFilter(AndTreeFilter.create(ANY_DIFF, notIgnoredFilter));

		return tw;
	}

